# 翻译和解释

## 程序设计语言

### 程序设计语言发展

机器语言➡符号语言➡汇编语言➡高级语言

### 高级语言具有的优点

- 更接近于自然语言、独立于机器
- 运行环境透明性
- 具有丰富的数据结构和控制结构，编程效率高

## 翻译程序

**编译器**：把源程序翻译成另一种表示形式的翻译器

**解释器**：直接执行源程序给出的运行结果的翻译器。解释器可以看作是一种模拟器，这种模拟器的“机器语言”就是要被翻译的语言。解释程序对源程序进行解释执行，即**边解释边执行**。

汇编程序：源语言是汇编语言，目标语言是机器语言

编译程序：源语言是高级语言，目标语言是某种机器的机器语言或汇编语言

# 编译的阶段和任务

根据编译程序的执行过程和所完成的任务，可分为分析阶段和综合阶段。

## 分析阶段

该阶段任务是根据源语言的定义对源程序进行结构分析和语义分析，从而把源程序正文转换为某种中间表示形式。

该阶段包括**词法分析、语法分析和语义分析**。

### 词法分析

词法分析是一种线性分析。

它在扫面源程序的过程中，对构成源程序的字符串进行分解，识别出每个具有独立意义的**字符串（单词，lexeme）**，并将它转换为**记号（token）**加以输出，所有单词的记号组成记号流。

词法分析的工作一句是源语言的构词规则（即语法），也成为**模式（pattern）**。

**单词分隔符（如空格、制表符、回车换行符等）通常在词法分析时被跳过去。**同时，注释也不做任何处理被直接跳过。

词法分析对某些记号还要增加一个“属性值”以示区别，并根据需要把标识符存入符号表。

### 语法分析

语法分析是一种层级结构的分析。

语法分析的工作依据是源语言的语法结构把记号流按层次分组，以形成短语。

程序的层次结构通常用递归规则表示。

### 语义分析

语义分析是对源程序的含义进行分析，以保证程序各部分能够有机地结合在一起并为以后生成目标代码收集必要的信息。

语义分析的工作依据是源语言的语义规则。

语义分析的一个重要任务是类型检查。

## 综合阶段

综合阶段的任务是根据源语言到目标语言的对应关系所产生的中间表示形式进行加工处理，从而得到与源程序等价的目标程序。

包括中间代码生成、代码优化和目标代码生成。

### 中间代码生成

通常编译程序需要把分析阶段产生 的结果进一步转换成中间代码。

中间代码应具备两个重要的特点：**易于产生**和**易于翻译成目标代码**。

### 代码优化

对代码进行改进，是指占用的空间少、运行速度快。

### 目标代码生成

生成的目标代码一般是可重定位的机器代码或汇编语言代码。

为了生存目标代码，需要对源程序中使用的每个变量指定存储单元，并且把每条中间代码语句一一翻译成等价的汇编语句或机器指令。为了得到高效的目标代码，需要充分利用目标机器的资源，尤其要实现寄存器的分配和使用。

## 符号表管理

编译程序的一项重要工作是收集源程序中使用的标识符，并记录每个标识符的相关信息，如源程序中使用的标识符是变量名、函数名还是形参名等。

编译程序使用符号表来记录标识符及其相关信息。标识符的各属性实在编译的不同阶段收集并写入符号表的。

## 错误处理

在编译的每一个阶段都可能检测出源程序中存在的错误。编译过程中，发现任何错误都应该报告给错误处理程序，以产生适当的诊断信息帮助程序员判断错误出现的准确位置，并对源程序进行适当的恢复以保持程序的一致性。

# 和编译有关的其他概念

## 编译的前端和后端

### 前端

与源语言有关而与目标机器无关的部分组成。包括**词法分析**、**语法分析**、**语义分析**、**中间代码生成**、**符号表的建立**、**中间代码的优化**，以及**相应的错误处理工作**和**符号表操作**。

### 后端

与目标机器有关的部分组成。包括**目标代码的生成**、**目标代码的优化**，以及**相应的错误处理**和**符号表操作**。

### 作用

便于编译程序的移植和构造。

## “遍”的概念

“遍”指的是对源程序或中间表示形式从头到尾扫描一次，并在扫描过程中完成相应的加工处理，生成新的中间表示形式或目标程序。

### 优点

- 减少对主存容量的要求
- 使编译程序结构清晰，各遍编译程序功能独立、单纯，相互联系简单
- 能够实现更充分的优化工作，以获得高质量的目标程序
- 通过分遍把编译程序前端和后端分开，可以为编译程序的构造和移植创造条件

### 缺点

增加了重复性工作

# 编译程序的伙伴工具

## 预处理器

使用用户所写的框架源程序产生编译程序的输入

### 宏处理

**宏定义**：对定义的变量或函数名进行替换

**宏调用**：用实参代替宏体中的形参

### 文件包含

把文件包含声明扩展为程序正文

### 语言扩充

通过宏调用实现对语言功能的扩充

# 编译原理的应用

- 结构化编译器
- 程序格式化工具
- 程序测试工具
- 程序理解工具