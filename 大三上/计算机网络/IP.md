# 概览

IP（Internet Protocol，网际互联协议），是TCP/IP体系中网络层协议，只为主机提供一种无连接、不可靠的、尽力而为的数据包传输服务。

IP对上可载送传输层各种协议的信息，例如TCP、UDP等；对下可将IP信息包放到链路层，通过以太网、令牌环网络等各种技术来传送。

## 目的

- 提高网络的可拓展性
- 解决互联网问题，实现大规模、异构网络的互联互通
- 分割顶层网络应用和底层网络技术之间的耦合关系，以利于两者的独立发展

# 主要内容

## IP分组的转发规则

**直接交付**：如果目标网络与本地路由器直接相连，则直接将数据包交付给目标主机。

**间接交付**：由器通过路由表查找路由信息，并将数据包转交给指明的下一跳路由器。

## IP分片

当路由器在转发IP包时，如果数据包的大小超过了出口链路的最大传输单元时，则会将该IP分组分解成很多足够小的片段，以便能够在目标链路上进行传输。这些IP分片重新封装一个IP包独立传输，并在到达目标主机时才会被重组起来。

## IP分组结构

一个IP分组由**首部**和**数据**两部分组成。首部的前20字节是所有IP分组必须具有的，也称固定首部。在首部固定部分的后面是一些可选字段，其长度是可变的。

### 首部

1. 第一字节：版本（4bit）和首部长度（4bit）
2. 第二字节：区分服务
3. 第三四字节：总长度
4. 第五六字节：标识
5. 第七八字节：标志（3bit）和片偏移（13bit）
6. 第九字节：生存时间
7. 第十字节：协议
8. 第十一和十二字节：首部校验和
9. 第十三到第十六字节：源地址
10. 第十七到第二十字节：目的地址

### 提供的服务

### IP信息包传送

#### 单点传送

单点传送是一对一的传递模式。在此模式下，源端所发出的IP信息包，其IP报头中的目的地址代表单一目的设备，因此只有该目的设备能收到此IP信息包。

#### 广播传送

广播传送是一对多的传递方式。在此方式下，源设备所发出的IP信息包，其IP报头中的目的地址代表某一网络，而非单一设备，因此该网络内的所有设备都能收到、并处理此类IP广播信息包。

#### 多点传送

多点传送是一种介于单点传送与广播传送之间的传送方式模式。多点传送也是属于一对多的传送方式，但是它与广播传送有很大的不同。广播传送必定会传送至某一个网络内的所有设备，但是多点传送却可以将信息包传送给一群指定的设备。即多点传送的IP信息包，其IP报头中的目的地址代表的是一群选定的设备。

### IP信息包的分割与重组